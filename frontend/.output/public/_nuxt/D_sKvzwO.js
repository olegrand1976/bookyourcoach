import{_ as A}from"./CGQ8kplI.js";import{f as U,g as q,r as R,h as g,i as T,c as d,a as s,d as x,b as k,w as E,j as F,k as C,l as y,v as M,m as o,n as j,F as B,p as I,t as S,o as u,q as i,s as L}from"./C0TLcctm.js";const $={class:"min-h-screen bg-gray-50"},z={class:"flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},D={class:"max-w-md w-full space-y-8"},P={class:"mt-2 text-center text-sm text-gray-700"},O={class:"mt-1 text-center text-sm text-gray-600"},G={class:"rounded-md shadow-sm -space-y-px"},H={class:"flex items-center justify-between"},J={class:"flex items-center"},K=["disabled"],Q={key:0},W={key:1},X={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-md p-4"},Y={class:"text-sm text-yellow-700"},Z={class:"list-disc list-inside"},ee={key:1,class:"bg-red-50 border border-red-200 rounded-md p-4"},se={class:"text-sm text-red-600"},ae={__name:"login",setup(te){const l=U();q();const w=(r,e="info")=>{console.log(`[${e.toUpperCase()}] ${r}`)},t=R({email:"",password:"",remember:!1}),c=g(!1),f=g(""),b=g([]),V=()=>{const r=[];return t.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||r.push("Format email invalide"):r.push("Email requis"),t.password?t.password.length<6&&r.push("Mot de passe trop court (minimum 6 caractères)"):r.push("Mot de passe requis"),r},N=async()=>{var e,p,a,v,h,_;c.value=!0,f.value="",b.value=[];const r=V();if(r.length>0){b.value=r,c.value=!1;return}try{await l.login({email:t.email,password:t.password}),w("Connexion réussie","success"),l.isAdmin?await i("/admin"):l.isTeacher?await i("/teacher/dashboard"):l.isClub?await i("/club/dashboard"):l.isStudent?await i("/student/dashboard"):await i("/dashboard")}catch(n){console.error("Erreur de connexion complète:",n),console.error("Response data:",(e=n.response)==null?void 0:e.data),console.error("Response status:",(p=n.response)==null?void 0:p.status),console.error("URL de base API:",L().public.apiBase);let m="Une erreur est survenue";(v=(a=n.response)==null?void 0:a.data)!=null&&v.message?m=n.response.data.message:n.code==="ECONNREFUSED"||n.message.includes("Network Error")?m="Impossible de se connecter au serveur. Vérifiez que l'API est accessible.":((h=n.response)==null?void 0:h.status)===422?m="Informations de connexion invalides":((_=n.response)==null?void 0:_.status)===401?m="Email ou mot de passe incorrect":m=`Erreur: ${n.message||"Erreur inconnue"}`,f.value=m,w("Erreur de connexion","error")}finally{c.value=!1}};return T(()=>{l.isAuthenticated&&(l.isAdmin?i("/admin"):l.isTeacher?i("/teacher/dashboard"):l.isClub?i("/club/dashboard"):l.isStudent?i("/student/dashboard"):i("/dashboard"))}),(r,e)=>{const p=A;return u(),d("div",$,[s("div",z,[s("div",D,[s("div",null,[e[7]||(e[7]=s("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Connexion ",-1)),s("p",P,[e[4]||(e[4]=x(" Pas encore de compte ? ",-1)),k(p,{to:"/register",class:"font-medium text-blue-400 bg-blue-600:text-yellow-600"},{default:E(()=>e[3]||(e[3]=[x(" Créer un compte ",-1)])),_:1,__:[3]})]),s("p",O,[e[6]||(e[6]=x(" Vous êtes enseignant ? ",-1)),k(p,{to:"/register-teacher",class:"font-medium text-emerald-600 hover:text-emerald-500"},{default:E(()=>e[5]||(e[5]=[x(" S'inscrire comme enseignant ",-1)])),_:1,__:[5]})])]),s("form",{class:"mt-8 space-y-6",onSubmit:F(N,["prevent"])},[s("div",G,[s("div",null,[e[8]||(e[8]=s("label",{for:"email",class:"sr-only"},"Email",-1)),y(s("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=a=>o(t).email=a),name:"email",type:"email",autocomplete:"email",required:"",class:"relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Adresse email"},null,512),[[M,o(t).email]])]),s("div",null,[e[9]||(e[9]=s("label",{for:"password",class:"sr-only"},"Mot de passe",-1)),y(s("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=a=>o(t).password=a),name:"password",type:"password",autocomplete:"current-password",required:"",class:"relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Mot de passe"},null,512),[[M,o(t).password]])])]),s("div",H,[s("div",J,[y(s("input",{id:"remember-me","onUpdate:modelValue":e[2]||(e[2]=a=>o(t).remember=a),name:"remember-me",type:"checkbox",class:"h-4 w-4 text-blue-400 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[j,o(t).remember]]),e[10]||(e[10]=s("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-900"}," Se souvenir de moi ",-1))]),e[11]||(e[11]=s("div",{class:"text-sm"},[s("a",{href:"#",class:"font-medium text-blue-400 bg-blue-600:text-yellow-600"}," Mot de passe oublié ? ")],-1))]),s("div",null,[s("button",{type:"submit",disabled:o(c),class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-500 bg-blue-600:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[o(c)?(u(),d("span",Q,"Connexion en cours...")):(u(),d("span",W,"Connexion"))],8,K)]),o(b).length>0?(u(),d("div",X,[s("div",Y,[s("ul",Z,[(u(!0),d(B,null,I(o(b),a=>(u(),d("li",{key:a},S(a),1))),128))])])])):C("",!0),o(f)?(u(),d("div",ee,[s("div",se,S(o(f)),1)])):C("",!0)],32)])])])}}};export{ae as default};
