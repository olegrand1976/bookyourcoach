import{e as v,C as N,h as b,r as S,g as $,c as u,a as t,d as i,t as a,i as r,H as C,F as R,s as D,o as c}from"./DS9r2nwn.js";const E={class:"p-8"},T={class:"bg-gray-100 p-4 rounded mb-4"},B={class:"bg-black text-green-400 p-4 rounded font-mono text-sm"},V={__name:"test-auth",setup(L){const o=v(),{$api:F}=N(),l=b(()=>o.user),h=b(()=>o.isAuthenticated),d=S([]);let y=0;function n(s){d.value.push({id:y++,message:`[${new Date().toLocaleTimeString()}] ${s}`})}async function k(){var s;n("🔄 Tentative de connexion...");try{await o.login({email:"admin.secours@activibe.com",password:"secours123"}),n(`✅ Connexion réussie - Role: ${(s=o.user)==null?void 0:s.role}`)}catch(e){n(`❌ Erreur: ${e.message}`)}}async function w(){var s;n("🔄 Rafraîchissement...");try{await o.fetchUser(),n(`✅ Rafraîchi - Role: ${(s=o.user)==null?void 0:s.role}`)}catch(e){n(`❌ Erreur: ${e.message}`)}}async function A(){n("🔄 Déconnexion..."),await o.logout(),n("✅ Déconnecté")}return $(()=>{n("🚀 Page chargée")}),(s,e)=>{var m,g,p,f;return c(),u("div",E,[e[6]||(e[6]=t("h1",{class:"text-2xl font-bold mb-4"},"🔍 Test Authentification Simple",-1)),t("div",T,[e[5]||(e[5]=t("h2",{class:"text-lg font-semibold mb-2"},"État actuel",-1)),t("p",null,[e[0]||(e[0]=t("strong",null,"Utilisateur:",-1)),i(" "+a(((m=r(l))==null?void 0:m.name)||"Non connecté"),1)]),t("p",null,[e[1]||(e[1]=t("strong",null,"Email:",-1)),i(" "+a(((g=r(l))==null?void 0:g.email)||"N/A"),1)]),t("p",null,[e[2]||(e[2]=t("strong",null,"Rôle:",-1)),e[3]||(e[3]=i()),t("span",{class:C(["font-bold",((p=r(l))==null?void 0:p.role)==="admin"?"text-green-600":"text-red-600"])},a(((f=r(l))==null?void 0:f.role)||"N/A"),3)]),t("p",null,[e[4]||(e[4]=t("strong",null,"Authentifié:",-1)),i(" "+a(r(h)?"✅ Oui":"❌ Non"),1)])]),t("div",{class:"space-y-2 mb-4"},[t("button",{onClick:k,class:"bg-blue-500 text-white px-4 py-2 rounded mr-2"},"Se connecter"),t("button",{onClick:w,class:"bg-green-500 text-white px-4 py-2 rounded mr-2"},"Rafraîchir"),t("button",{onClick:A,class:"bg-red-500 text-white px-4 py-2 rounded"},"Se déconnecter")]),t("div",B,[(c(!0),u(R,null,D(r(d),x=>(c(),u("div",{key:x.id},a(x.message),1))),128))])])}}};export{V as default};
