import{af as c,f as d,q as i,ag as u,U as n}from"./C0TLcctm.js";const m=c(async f=>{var s,a;let r,t;const e=d();if(!e.token)return i("/login");try{if([r,t]=u(()=>e.fetchUser()),await r,t(),!e.user||e.user.role!=="admin")throw console.error("Utilisateur non-admin détecté:",(s=e.user)==null?void 0:s.role),n({statusCode:403,statusMessage:"Accès refusé - Droits administrateur requis"})}catch(o){if(console.error("Erreur vérification admin:",o),((a=o.response)==null?void 0:a.status)===401)return[r,t]=u(()=>e.logout()),await r,t(),i("/login?expired=true");throw n({statusCode:403,statusMessage:"Accès refusé - Droits administrateur requis"})}});export{m as default};
