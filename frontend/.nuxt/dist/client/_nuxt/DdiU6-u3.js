import{Z as F,h as u,D as E,x as I,c as l,a as t,k as g,l as p,z as f,F as x,p as y,v as A,t as i,B as c,o as n,H as N,d as b}from"./D1UknV-R.js";import{_ as U}from"./DlAUqK2U.js";const q={class:"lessons-page"},R={class:"container mx-auto px-4 py-8"},H={class:"bg-white rounded-lg shadow-md p-6 mb-8"},P={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Z=["value"],G=["value"],J={key:0,class:"flex justify-center items-center py-12"},K={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 mb-6"},O={class:"flex items-center"},Q={class:"ml-3"},W={class:"mt-2 text-sm text-red-700"},X={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Y={class:"p-6"},ee={class:"flex items-start justify-between mb-4"},te={class:"text-lg font-semibold text-gray-900 mb-1"},se={class:"text-sm text-gray-600"},oe={class:"flex items-center mb-4"},re={class:"ml-3"},le={class:"text-sm font-medium text-gray-900"},ne={class:"space-y-2 mb-4"},ie={class:"flex items-center text-sm text-gray-600"},ae={class:"flex items-center text-sm text-gray-600"},de={class:"flex items-center text-sm text-gray-600"},ue={key:0,class:"text-sm text-gray-600 mb-4 line-clamp-2"},ce={class:"flex space-x-2"},me=["onClick"],pe=["onClick"],ve={key:3,class:"text-center py-12"},ge=F({__name:"lessons",setup(fe){const w=u([]),v=u([]),m=u(!1),d=u(null),r=u({discipline:"",courseType:"",format:"",date:""}),L=E(()=>{if(!r.value.discipline)return[];const o=v.value.find(e=>e.id===parseInt(r.value.discipline));return(o==null?void 0:o.course_types)||[]}),k=E(()=>{let o=w.value;if(r.value.discipline&&(o=o.filter(e=>{var s;return((s=e.course_type)==null?void 0:s.discipline_id)===parseInt(r.value.discipline)})),r.value.courseType&&(o=o.filter(e=>{var s;return((s=e.course_type)==null?void 0:s.id)===parseInt(r.value.courseType)})),r.value.format&&(o=o.filter(e=>{var s,a;return r.value.format==="individual"?((s=e.course_type)==null?void 0:s.is_individual)===!0:r.value.format==="group"?((a=e.course_type)==null?void 0:a.is_individual)===!1:!0})),r.value.date){const e=new Date(r.value.date);o=o.filter(s=>new Date(s.start_time).toDateString()===e.toDateString())}return o}),h=async()=>{try{m.value=!0,d.value=null;const{$api:o}=c(),e=await o.get("/student/available-lessons");if(e.data.success)w.value=e.data.data;else throw new Error("Erreur lors du chargement des leçons")}catch(o){d.value=o.message||"Erreur lors du chargement des leçons",console.error("Error loading lessons:",o)}finally{m.value=!1}},T=async()=>{try{const{$api:o}=c(),e=await o.get("/student/disciplines");e.data.success&&(v.value=e.data.data)}catch(o){console.error("Error loading disciplines:",o)}},M=()=>{console.log("Filters applied:",r.value)},z=async o=>{try{const{$api:e}=c(),s=await e.post("/student/bookings",{lesson_id:o});if(s.data.success){await h();const{$toast:a}=c();a.success("Leçon réservée avec succès!")}else throw new Error(s.data.message||"Erreur lors de la réservation")}catch(e){const{$toast:s}=c();s.error(e.message||"Erreur lors de la réservation"),console.error("Error booking lesson:",e)}},j=o=>{console.log("View lesson details:",o)},B=o=>{switch(o){case"available":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"completed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},V=o=>{switch(o){case"available":return"Disponible";case"pending":return"En attente";case"confirmed":return"Confirmé";case"completed":return"Terminé";case"cancelled":return"Annulé";default:return o}},S=o=>new Date(o).toLocaleDateString("fr-FR",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});return I(()=>{h(),T()}),(o,e)=>(n(),l("div",q,[t("div",R,[e[21]||(e[21]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," Leçons Disponibles "),t("p",{class:"text-gray-600"}," Découvrez et réservez les cours qui vous intéressent ")],-1)),t("div",H,[e[11]||(e[11]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Filtres",-1)),t("div",P,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Discipline",-1)),p(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.discipline=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[4]||(e[4]=t("option",{value:""},"Toutes les disciplines",-1)),(n(!0),l(x,null,y(v.value,s=>(n(),l("option",{key:s.id,value:s.id},i(s.name),9,Z))),128))],512),[[f,r.value.discipline]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type de cours",-1)),p(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.courseType=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[6]||(e[6]=t("option",{value:""},"Tous les types",-1)),(n(!0),l(x,null,y(L.value,s=>(n(),l("option",{key:s.id,value:s.id},i(s.name),9,G))),128))],512),[[f,r.value.courseType]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Format",-1)),p(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.format=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},e[8]||(e[8]=[t("option",{value:""},"Tous les formats",-1),t("option",{value:"individual"},"Individuel",-1),t("option",{value:"group"},"Collectif",-1)]),512),[[f,r.value.format]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date",-1)),p(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[A,r.value.date]])])]),t("div",{class:"mt-4 flex justify-end"},[t("button",{onClick:M,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"}," Appliquer les filtres ")])]),m.value?(n(),l("div",J,e[12]||(e[12]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):d.value?(n(),l("div",K,[t("div",O,[e[14]||(e[14]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),t("div",Q,[e[13]||(e[13]=t("h3",{class:"text-sm font-medium text-red-800"},"Erreur",-1)),t("div",W,i(d.value),1)])])])):(n(),l("div",X,[(n(!0),l(x,null,y(k.value,s=>{var a,_,C,D;return n(),l("div",{key:s.id,class:"bg-white rounded-lg shadow-md border border-gray-200 hover:shadow-lg transition-shadow"},[t("div",Y,[t("div",ee,[t("div",null,[t("h3",te,i(s.title||"Leçon"),1),t("p",se,i(((a=s.course_type)==null?void 0:a.name)||"Type non spécifié"),1)]),t("span",{class:N(["px-2 py-1 text-xs font-medium rounded-full",B(s.status)])},i(V(s.status)),3)]),t("div",oe,[e[16]||(e[16]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center"},[t("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])])],-1)),t("div",re,[t("p",le,i(((C=(_=s.teacher)==null?void 0:_.user)==null?void 0:C.name)||"Enseignant"),1),e[15]||(e[15]=t("p",{class:"text-xs text-gray-500"},"Enseignant",-1))])]),t("div",ne,[t("div",ie,[e[17]||(e[17]=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),b(" "+i(S(s.start_time)),1)]),t("div",ae,[e[18]||(e[18]=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),b(" "+i(((D=s.location)==null?void 0:D.name)||"Lieu non spécifié"),1)]),t("div",de,[e[19]||(e[19]=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})],-1)),b(" "+i(s.price?`${s.price}€`:"Prix non spécifié"),1)])]),s.description?(n(),l("p",ue,i(s.description),1)):g("",!0),t("div",ce,[s.status==="available"?(n(),l("button",{key:0,onClick:$=>z(s.id),class:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors text-sm font-medium"}," Réserver ",8,me)):g("",!0),t("button",{onClick:$=>j(s.id),class:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors text-sm font-medium"}," Détails ",8,pe)])])])}),128))])),!m.value&&!d.value&&k.value.length===0?(n(),l("div",ve,e[20]||(e[20]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Aucune leçon trouvée",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"Essayez de modifier vos filtres de recherche.",-1)]))):g("",!0)])]))}}),be=U(ge,[["__scopeId","data-v-8d87c433"]]);export{be as default};
