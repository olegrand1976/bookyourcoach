import{_ as c,e as d,V as i}from"./B73CQWOX.js";const w=c(e=>{var a,o,n;const s=d();if(!s.isAuthenticated)throw i({statusCode:401,statusMessage:"Authentification requise"});const t=e.meta.requiresRole;if(t&&((a=s.user)==null?void 0:a.role)!==t)throw console.warn(`Tentative d'accès non autorisé à ${e.path} - Rôle requis: ${t}, Rôle utilisateur: ${(o=s.user)==null?void 0:o.role}`),i({statusCode:403,statusMessage:"Accès non autorisé pour ce rôle"});const r=e.meta.requiresPermissions;if(r&&r.length>0){const u=m((n=s.user)==null?void 0:n.role);if(!r.every(l=>u.includes(l)))throw i({statusCode:403,statusMessage:"Permissions insuffisantes"})}});function m(e){switch(e){case"admin":return["read","write","delete","manage_users","manage_settings"];case"teacher":return["read","write","manage_lessons","view_students"];case"student":return["read","book_lessons","view_profile"];default:return[]}}export{w as default};
