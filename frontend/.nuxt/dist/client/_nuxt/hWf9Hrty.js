import{_ as I}from"./DxhIiSfk.js";import{Z as O,h as u,D as P,x as Z,c as r,a as e,F as z,p as D,t as o,k as d,b as q,w as J,B as m,o as l,H as $,d as K}from"./CplJ7MsP.js";import{_ as Q}from"./DlAUqK2U.js";const U={class:"bookings-page"},W={class:"container mx-auto px-4 py-8"},X={class:"bg-white rounded-lg shadow-md p-6 mb-8"},Y={class:"flex flex-wrap gap-2"},ee=["onClick"],te={key:0,class:"flex justify-center items-center py-12"},se={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 mb-6"},ne={class:"flex items-center"},oe={class:"ml-3"},re={class:"mt-2 text-sm text-red-700"},le={key:2,class:"space-y-6"},ae={class:"p-6"},ie={class:"flex items-start justify-between mb-4"},de={class:"text-lg font-semibold text-gray-900 mb-1"},ce={class:"text-sm text-gray-600"},ue={class:"flex items-center mb-4"},me={class:"ml-3"},ve={class:"text-sm font-medium text-gray-900"},xe={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},pe={class:"flex items-center text-sm text-gray-600"},ge={class:"font-medium"},fe={class:"text-xs"},_e={class:"flex items-center text-sm text-gray-600"},he={class:"font-medium"},ye={class:"flex items-center text-sm text-gray-600"},we={class:"font-medium"},be={key:0,class:"mb-4"},ke={class:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md"},Ce={class:"flex space-x-2"},Be=["onClick"],Ee=["onClick"],Me=["onClick"],Ve={key:0,class:"text-center py-12"},Le={class:"mt-1 text-sm text-gray-500"},ze={key:0,class:"mt-4"},De=O({__name:"bookings",setup($e){const v=u([]),x=u(!1),c=u(null),a=u("all"),j=[{value:"all",label:"Toutes"},{value:"pending",label:"En attente"},{value:"confirmed",label:"Confirmées"},{value:"completed",label:"Terminées"},{value:"cancelled",label:"Annulées"}],g=P(()=>a.value==="all"?v.value:v.value.filter(s=>s.status===a.value)),f=async()=>{try{x.value=!0,c.value=null;const{$api:s}=m(),t=await s.get("/student/bookings");if(t.data.success)v.value=t.data.data;else throw new Error("Erreur lors du chargement des réservations")}catch(s){c.value=s.message||"Erreur lors du chargement des réservations",console.error("Error loading bookings:",s)}finally{x.value=!1}},N=async s=>{if(confirm("Êtes-vous sûr de vouloir annuler cette réservation ?"))try{const{$api:t}=m(),i=await t.put(`/student/bookings/${s}/cancel`);if(i.data.success){await f();const{$toast:n}=m();n.success("Réservation annulée avec succès!")}else throw new Error(i.data.message||"Erreur lors de l'annulation")}catch(t){const{$toast:i}=m();i.error(t.message||"Erreur lors de l'annulation"),console.error("Error cancelling booking:",t)}},T=s=>{console.log("Rate lesson:",s)},A=s=>{console.log("View booking details:",s)},R=s=>{var t;return["pending","confirmed"].includes(s.status)&&new Date((t=s.lesson)==null?void 0:t.start_time)>new Date},S=s=>s.status==="completed"&&!s.rating,F=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},H=s=>{switch(s){case"pending":return"En attente";case"confirmed":return"Confirmée";case"completed":return"Terminée";case"cancelled":return"Annulée";default:return s}},G=s=>new Date(s).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}),_=s=>new Date(s).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});return Z(()=>{f()}),(s,t)=>{const i=I;return l(),r("div",U,[e("div",W,[t[13]||(t[13]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," Mes Réservations "),e("p",{class:"text-gray-600"}," Gérez vos cours réservés et votre planning ")],-1)),e("div",X,[t[0]||(t[0]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Filtrer par statut",-1)),e("div",Y,[(l(),r(z,null,D(j,n=>e("button",{key:n.value,onClick:p=>a.value=n.value,class:$(["px-4 py-2 rounded-md text-sm font-medium transition-colors",a.value===n.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},o(n.label),11,ee)),64))])]),x.value?(l(),r("div",te,t[1]||(t[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):c.value?(l(),r("div",se,[e("div",ne,[t[3]||(t[3]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",oe,[t[2]||(t[2]=e("h3",{class:"text-sm font-medium text-red-800"},"Erreur",-1)),e("div",re,o(c.value),1)])])])):(l(),r("div",le,[(l(!0),r(z,null,D(g.value,n=>{var p,h,y,w,b,k,C,B,E,M,V;return l(),r("div",{key:n.id,class:"bg-white rounded-lg shadow-md border border-gray-200"},[e("div",ae,[e("div",ie,[e("div",null,[e("h3",de,o(((p=n.lesson)==null?void 0:p.title)||"Leçon"),1),e("p",ce,o(((y=(h=n.lesson)==null?void 0:h.course_type)==null?void 0:y.name)||"Type non spécifié"),1)]),e("span",{class:$(["px-3 py-1 text-sm font-medium rounded-full",F(n.status)])},o(H(n.status)),3)]),e("div",ue,[t[5]||(t[5]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])])],-1)),e("div",me,[e("p",ve,o(((k=(b=(w=n.lesson)==null?void 0:w.teacher)==null?void 0:b.user)==null?void 0:k.name)||"Enseignant"),1),t[4]||(t[4]=e("p",{class:"text-xs text-gray-500"},"Enseignant",-1))])]),e("div",xe,[e("div",pe,[t[6]||(t[6]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("div",null,[e("p",ge,o(G((C=n.lesson)==null?void 0:C.start_time)),1),e("p",fe,o(_((B=n.lesson)==null?void 0:B.start_time))+" - "+o(_((E=n.lesson)==null?void 0:E.end_time)),1)])]),e("div",_e,[t[7]||(t[7]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),e("div",null,[e("p",he,o(((V=(M=n.lesson)==null?void 0:M.location)==null?void 0:V.name)||"Lieu non spécifié"),1)])]),e("div",ye,[t[8]||(t[8]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})],-1)),e("div",null,[e("p",we,o(n.price?`${n.price}€`:"Prix non spécifié"),1)])])]),n.notes?(l(),r("div",be,[t[9]||(t[9]=e("h4",{class:"text-sm font-medium text-gray-900 mb-1"},"Notes",-1)),e("p",ke,o(n.notes),1)])):d("",!0),e("div",Ce,[R(n)?(l(),r("button",{key:0,onClick:L=>N(n.id),class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium"}," Annuler ",8,Be)):d("",!0),S(n)?(l(),r("button",{key:1,onClick:L=>T(n),class:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors text-sm font-medium"}," Noter ",8,Ee)):d("",!0),e("button",{onClick:L=>A(n.id),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-sm font-medium"}," Détails ",8,Me)])])])}),128)),g.value.length===0?(l(),r("div",Ve,[t[11]||(t[11]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),t[12]||(t[12]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Aucune réservation",-1)),e("p",Le,o(a.value==="all"?"Vous n'avez pas encore de réservations.":"Aucune réservation avec ce statut."),1),a.value==="all"?(l(),r("div",ze,[q(i,{to:"/student/lessons",class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},{default:J(()=>t[10]||(t[10]=[K(" Voir les leçons disponibles ",-1)])),_:1,__:[10]})])):d("",!0)])):d("",!0)]))])])}}}),Ae=Q(De,[["__scopeId","data-v-1c22a316"]]);export{Ae as default};
