import{_ as n,e as c,n as o,$ as i,V as u}from"./D0Y81rF_.js";const m=n(async d=>{var s;let e,t;const r=c();if(!r.token)return o("/login");try{if([e,t]=i(()=>r.fetchUser()),await e,t(),!r.isAdmin)throw u({statusCode:403,statusMessage:"Accès refusé - Droits administrateur requis"})}catch(a){if(console.error("Erreur vérification admin:",a),((s=a.response)==null?void 0:s.status)===401)return[e,t]=i(()=>r.logout()),await e,t(),o("/login?expired=true");throw u({statusCode:403,statusMessage:"Accès refusé - Droits administrateur requis"})}});export{m as default};
