{"version":3,"file":"bookings-BTPCrP_m.js","sources":["../../../../pages/student/bookings.vue"],"sourcesContent":["<template>\n  <div class=\"bookings-page\">\n    <div class=\"container mx-auto px-4 py-8\">\n      <!-- Header -->\n      <div class=\"mb-8\">\n        <h1 class=\"text-3xl font-bold text-gray-900 mb-2\">\n          Mes Réservations\n        </h1>\n        <p class=\"text-gray-600\">\n          Gérez vos cours réservés et votre planning\n        </p>\n      </div>\n\n      <!-- Status Filter -->\n      <div class=\"bg-white rounded-lg shadow-md p-6 mb-8\">\n        <h2 class=\"text-lg font-semibold text-gray-900 mb-4\">Filtrer par statut</h2>\n        <div class=\"flex flex-wrap gap-2\">\n          <button \n            v-for=\"status in statusOptions\" \n            :key=\"status.value\"\n            @click=\"selectedStatus = status.value\"\n            :class=\"[\n              'px-4 py-2 rounded-md text-sm font-medium transition-colors',\n              selectedStatus === status.value\n                ? 'bg-blue-600 text-white'\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n            ]\"\n          >\n            {{ status.label }}\n          </button>\n        </div>\n      </div>\n\n      <!-- Loading State -->\n      <div v-if=\"loading\" class=\"flex justify-center items-center py-12\">\n        <div class=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n\n      <!-- Error State -->\n      <div v-else-if=\"error\" class=\"bg-red-50 border border-red-200 rounded-lg p-6 mb-6\">\n        <div class=\"flex items-center\">\n          <div class=\"flex-shrink-0\">\n            <svg class=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\" />\n            </svg>\n          </div>\n          <div class=\"ml-3\">\n            <h3 class=\"text-sm font-medium text-red-800\">Erreur</h3>\n            <div class=\"mt-2 text-sm text-red-700\">{{ error }}</div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Bookings List -->\n      <div v-else class=\"space-y-6\">\n        <div \n          v-for=\"booking in filteredBookings\" \n          :key=\"booking.id\"\n          class=\"bg-white rounded-lg shadow-md border border-gray-200\"\n        >\n          <div class=\"p-6\">\n            <!-- Booking Header -->\n            <div class=\"flex items-start justify-between mb-4\">\n              <div>\n                <h3 class=\"text-lg font-semibold text-gray-900 mb-1\">\n                  {{ booking.lesson?.title || 'Leçon' }}\n                </h3>\n                <p class=\"text-sm text-gray-600\">\n                  {{ booking.lesson?.course_type?.name || 'Type non spécifié' }}\n                </p>\n              </div>\n              <span \n                :class=\"[\n                  'px-3 py-1 text-sm font-medium rounded-full',\n                  getStatusClass(booking.status)\n                ]\"\n              >\n                {{ getStatusText(booking.status) }}\n              </span>\n            </div>\n\n            <!-- Teacher Info -->\n            <div class=\"flex items-center mb-4\">\n              <div class=\"flex-shrink-0\">\n                <div class=\"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center\">\n                  <svg class=\"w-5 h-5 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                  </svg>\n                </div>\n              </div>\n              <div class=\"ml-3\">\n                <p class=\"text-sm font-medium text-gray-900\">\n                  {{ booking.lesson?.teacher?.user?.name || 'Enseignant' }}\n                </p>\n                <p class=\"text-xs text-gray-500\">Enseignant</p>\n              </div>\n            </div>\n\n            <!-- Booking Details -->\n            <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n              <div class=\"flex items-center text-sm text-gray-600\">\n                <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                </svg>\n                <div>\n                  <p class=\"font-medium\">{{ formatDate(booking.lesson?.start_time) }}</p>\n                  <p class=\"text-xs\">{{ formatTime(booking.lesson?.start_time) }} - {{ formatTime(booking.lesson?.end_time) }}</p>\n                </div>\n              </div>\n              \n              <div class=\"flex items-center text-sm text-gray-600\">\n                <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\n                </svg>\n                <div>\n                  <p class=\"font-medium\">{{ booking.lesson?.location?.name || 'Lieu non spécifié' }}</p>\n                </div>\n              </div>\n\n              <div class=\"flex items-center text-sm text-gray-600\">\n                <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\" />\n                </svg>\n                <div>\n                  <p class=\"font-medium\">{{ booking.price ? `${booking.price}€` : 'Prix non spécifié' }}</p>\n                </div>\n              </div>\n            </div>\n\n            <!-- Notes -->\n            <div v-if=\"booking.notes\" class=\"mb-4\">\n              <h4 class=\"text-sm font-medium text-gray-900 mb-1\">Notes</h4>\n              <p class=\"text-sm text-gray-600 bg-gray-50 p-3 rounded-md\">\n                {{ booking.notes }}\n              </p>\n            </div>\n\n            <!-- Actions -->\n            <div class=\"flex space-x-2\">\n              <button \n                v-if=\"canCancel(booking)\"\n                @click=\"cancelBooking(booking.id)\"\n                class=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm font-medium\"\n              >\n                Annuler\n              </button>\n              \n              <button \n                v-if=\"canRate(booking)\"\n                @click=\"rateLesson(booking)\"\n                class=\"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors text-sm font-medium\"\n              >\n                Noter\n              </button>\n              \n              <button \n                @click=\"viewBookingDetails(booking.id)\"\n                class=\"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-sm font-medium\"\n              >\n                Détails\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <!-- Empty State -->\n        <div v-if=\"filteredBookings.length === 0\" class=\"text-center py-12\">\n          <svg class=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n          </svg>\n          <h3 class=\"mt-2 text-sm font-medium text-gray-900\">Aucune réservation</h3>\n          <p class=\"mt-1 text-sm text-gray-500\">\n            {{ selectedStatus === 'all' ? 'Vous n\\'avez pas encore de réservations.' : 'Aucune réservation avec ce statut.' }}\n          </p>\n          <div v-if=\"selectedStatus === 'all'\" class=\"mt-4\">\n            <NuxtLink \n              to=\"/student/lessons\"\n              class=\"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\n            >\n              Voir les leçons disponibles\n            </NuxtLink>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted } from 'vue'\n\n// Meta\ndefinePageMeta({\n  middleware: ['auth', 'student'],\n  layout: 'student'\n})\n\n// State\nconst bookings = ref<any[]>([])\nconst loading = ref(false)\nconst error = ref<string | null>(null)\nconst selectedStatus = ref('all')\n\nconst statusOptions = [\n  { value: 'all', label: 'Toutes' },\n  { value: 'pending', label: 'En attente' },\n  { value: 'confirmed', label: 'Confirmées' },\n  { value: 'completed', label: 'Terminées' },\n  { value: 'cancelled', label: 'Annulées' }\n]\n\n// Computed\nconst filteredBookings = computed(() => {\n  if (selectedStatus.value === 'all') {\n    return bookings.value\n  }\n  return bookings.value.filter(booking => booking.status === selectedStatus.value)\n})\n\n// Methods\nconst loadBookings = async () => {\n  try {\n    loading.value = true\n    error.value = null\n    \n    const { $api } = useNuxtApp()\n    const response = await $api.get('/student/bookings')\n    \n    if (response.data.success) {\n      bookings.value = response.data.data\n    } else {\n      throw new Error('Erreur lors du chargement des réservations')\n    }\n  } catch (err: any) {\n    error.value = err.message || 'Erreur lors du chargement des réservations'\n    console.error('Error loading bookings:', err)\n  } finally {\n    loading.value = false\n  }\n}\n\nconst cancelBooking = async (bookingId: number) => {\n  if (!confirm('Êtes-vous sûr de vouloir annuler cette réservation ?')) {\n    return\n  }\n\n  try {\n    const { $api } = useNuxtApp()\n    const response = await $api.put(`/student/bookings/${bookingId}/cancel`)\n    \n    if (response.data.success) {\n      // Recharger les réservations\n      await loadBookings()\n      \n      const { $toast } = useNuxtApp()\n      $toast.success('Réservation annulée avec succès!')\n    } else {\n      throw new Error(response.data.message || 'Erreur lors de l\\'annulation')\n    }\n  } catch (err: any) {\n    const { $toast } = useNuxtApp()\n    $toast.error(err.message || 'Erreur lors de l\\'annulation')\n    console.error('Error cancelling booking:', err)\n  }\n}\n\nconst rateLesson = (booking: any) => {\n  // Ouvrir un modal de notation (à implémenter)\n  console.log('Rate lesson:', booking)\n}\n\nconst viewBookingDetails = (bookingId: number) => {\n  // Navigation vers la page de détails (à implémenter)\n  console.log('View booking details:', bookingId)\n}\n\nconst canCancel = (booking: any) => {\n  return ['pending', 'confirmed'].includes(booking.status) && \n         new Date(booking.lesson?.start_time) > new Date()\n}\n\nconst canRate = (booking: any) => {\n  return booking.status === 'completed' && !booking.rating\n}\n\nconst getStatusClass = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800'\n    case 'confirmed':\n      return 'bg-blue-100 text-blue-800'\n    case 'completed':\n      return 'bg-green-100 text-green-800'\n    case 'cancelled':\n      return 'bg-red-100 text-red-800'\n    default:\n      return 'bg-gray-100 text-gray-800'\n  }\n}\n\nconst getStatusText = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'En attente'\n    case 'confirmed':\n      return 'Confirmée'\n    case 'completed':\n      return 'Terminée'\n    case 'cancelled':\n      return 'Annulée'\n    default:\n      return status\n  }\n}\n\nconst formatDate = (dateString: string) => {\n  const date = new Date(dateString)\n  return date.toLocaleDateString('fr-FR', {\n    weekday: 'long',\n    day: 'numeric',\n    month: 'long'\n  })\n}\n\nconst formatTime = (dateString: string) => {\n  const date = new Date(dateString)\n  return date.toLocaleTimeString('fr-FR', {\n    hour: '2-digit',\n    minute: '2-digit'\n  })\n}\n\n// Lifecycle\nonMounted(() => {\n  loadBookings()\n})\n</script>\n\n<style scoped>\n.bookings-page {\n  min-height: 100vh;\n  background-color: #f9fafb;\n}\n</style>\n"],"names":["bookings","_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrInterpolate","_push","_parent"],"mappings":"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"}