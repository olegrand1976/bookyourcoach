import{Z as n,e as c,n as o,_ as i,U as u}from"./B2BDWZP7.js";const m=n(async d=>{var s;let t,e;const r=c();if(!r.token)return o("/login");try{if([t,e]=i(()=>r.fetchUser()),await t,e(),!r.isAdmin)throw u({statusCode:403,statusMessage:"Accès refusé - Droits administrateur requis"})}catch(a){if(console.error("Erreur vérification admin:",a),((s=a.response)==null?void 0:s.status)===401)return[t,e]=i(()=>r.logout()),await t,e(),o("/login?expired=true");throw u({statusCode:403,statusMessage:"Accès refusé - Droits administrateur requis"})}});export{m as default};
